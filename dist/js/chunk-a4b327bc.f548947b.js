(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a4b327bc"],{"006a":function(t,e,s){t.exports=s.p+"img/7.bb11ee62.svg"},"06bb":function(t,e,s){"use strict";var i=function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"select-token-dialog",attrs:{visible:t.dialog,"modal-append-to-body":!1,"before-close":t.onClose,"show-close":!1},on:{"update:visible":function(e){t.dialog=e}}},[e("div",{staticClass:"el-dialog__header__inner",attrs:{slot:"title"},slot:"title"},[e("span",{staticClass:"el-dialog__title"},[t._v(" "+t._s(t.$t("select_token.select_token"))+" ")]),e("svg",{staticClass:"close-svg",attrs:{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},on:{click:t.onCloseDialog}},[e("path",{attrs:{d:"M18 6L6 18","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}}),e("path",{attrs:{d:"M6 6L18 18","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}})])]),e("div",{staticClass:"search-box"},[e("el-input",{staticClass:"search-input",attrs:{placeholder:t.$t("select_token.search_name_address")},on:{input:t.onSearchTokenInput},model:{value:t.searchToken,callback:function(e){t.searchToken=e},expression:"searchToken"}})],1),e("el-scrollbar",{staticStyle:{height:"440px"}},[t.activeCoinList.length?e("div",{staticClass:"token-list"},t._l(t.activeCoinList,(function(i){return e("div",{key:i.address,staticClass:"item",on:{click:function(e){return t.onClickTokenItem(i)}}},[(i.piclink,e("img",{staticClass:"icon",attrs:{src:s("006a"),alt:""}})),e("div",{staticClass:"text"},[e("div",{staticClass:"name"},[t._v(t._s(i.symbol))]),e("div",{staticClass:"from"},[t._v(t._s(t._f("addressFilter")(i.address)))])])])})),0):e("div",{staticClass:"no-data"},[e("div",{staticClass:"text"},[t._v(t._s(t.$t("select_token.no_data")))])])])],1)},r=[],a=s("365c"),n=s("26ba"),o={name:"SelectToken",props:{selectTokenDialog:{type:Boolean}},computed:{isWeb3Connected(){return this.$store.getters.isWeb3Connected},networkName(){return this.$store.getters.network}},data(){return{dialog:!1,inputTimer:null,searchToken:"",activeCoinList:[]}},watch:{selectTokenDialog(t){this.dialog=t,t?this.activeCoinList=[{id:18,network:"BscMainnet",symbol:"ETH",address:"0x2170ed0880ac9a755fd29b2688956bd959f933f8",decimal:18},{id:18,network:"BscMainnet",symbol:"BTC",address:"0x7130d2a12b9bcbfae4f2634d864a1ee1ce3ead9c",decimal:18},{id:18,network:"BscMainnet",symbol:"USDT",address:"0x55d398326f99059ff775485246999027b3197955",decimal:18},{id:18,network:"BscMainnet",symbol:"BNB",address:"0xbb4cdb9cbd36b01bd1cbaebf2de08d9173bc095c",decimal:18},{id:18,network:"BscMainnet",symbol:"STORE",address:"0x65d9033cff96782394dab5dbef17fa771bbe1732",decimal:18}]:this.searchToken=""}},methods:{onCloseDialog(){this.dialog=!1,this.$emit("closeDialog","")},onClose(t){this.onCloseDialog(),t()},onClickTokenItem(t){t.isContractCoin&&Object(a["h"])({network:t.network,symbol:t.symbol,address:t.address}),this.$emit("setCurrency",t)},debounce(t,e,s=200){this.inputTimer&&clearTimeout(this.inputTimer),this.inputTimer=setTimeout(()=>{t(e)},s)},onSearchTokenInput(){this.debounce(this.getSelectcoin,null,200)},async getSelectcoin(){let t={info:this.searchToken,network:this.networkName};Object(a["j"])(t).then(t=>{"200"===t.code&&(0===t.result.length?this.$isAddress(this.searchToken)&&this.isWeb3Connected?n["y"](this.searchToken).then(t=>{this.activeCoinList=[{address:this.searchToken.toLowerCase(),ismainstream:"",level:"",network:this.networkName,piclink:s("006a"),price:"",projectname:null,rgb:"",symbol:t,textlogo:null,isContractCoin:!0}]}).catch(t=>{this.activeCoinList=[]}):this.activeCoinList=[]:this.activeCoinList=t.result)})}}},c=o,u=(s("30fd"),s("2877")),l=Object(u["a"])(c,i,r,!1,null,"fce802f8",null);e["a"]=l.exports},"30fd":function(t,e,s){"use strict";s("ac96")},"7f1d":function(t,e,s){"use strict";s("b4da")},ac96:function(t,e,s){},b4da:function(t,e,s){},f20b:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"addliquidity-container"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-header flex aic jcsb"},[e("svg",{staticClass:"back",attrs:{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},on:{click:t.onBack}},[e("path",{attrs:{d:"M19 12H5","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}}),e("path",{attrs:{d:"M12 19L5 12L12 5","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}})]),e("span",{staticClass:"text"},[t._v(t._s(t.$t("liquidity_addliquidity.add_liquidity")))]),e("svg",{staticClass:"img",staticStyle:{cursor:"default"},attrs:{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("g",{attrs:{"clip-path":"url(#clip0_1446_43072)"}},[e("path",{attrs:{d:"M10 12.5C11.3807 12.5 12.5 11.3807 12.5 10C12.5 8.61929 11.3807 7.5 10 7.5C8.61929 7.5 7.5 8.61929 7.5 10C7.5 11.3807 8.61929 12.5 10 12.5Z","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}}),e("path",{attrs:{d:"M16.1654 12.4997C16.0544 12.751 16.0213 13.0298 16.0704 13.3002C16.1194 13.5705 16.2482 13.8199 16.4404 14.0163L16.4904 14.0663C16.6453 14.2211 16.7683 14.4049 16.8521 14.6073C16.936 14.8096 16.9792 15.0265 16.9792 15.2455C16.9792 15.4645 16.936 15.6814 16.8521 15.8837C16.7683 16.0861 16.6453 16.2699 16.4904 16.4247C16.3356 16.5796 16.1518 16.7026 15.9494 16.7864C15.7471 16.8703 15.5302 16.9135 15.3112 16.9135C15.0922 16.9135 14.8753 16.8703 14.673 16.7864C14.4706 16.7026 14.2868 16.5796 14.132 16.4247L14.082 16.3747C13.8856 16.1826 13.6362 16.0537 13.3659 16.0047C13.0955 15.9557 12.8167 15.9887 12.5654 16.0997C12.3189 16.2053 12.1087 16.3807 11.9606 16.6043C11.8126 16.8279 11.7331 17.0899 11.732 17.358V17.4997C11.732 17.9417 11.5564 18.3656 11.2439 18.6782C10.9313 18.9907 10.5074 19.1663 10.0654 19.1663C9.62334 19.1663 9.19941 18.9907 8.88685 18.6782C8.57429 18.3656 8.3987 17.9417 8.3987 17.4997V17.4247C8.39225 17.1488 8.30296 16.8813 8.14246 16.6569C7.98195 16.4325 7.75764 16.2616 7.4987 16.1663C7.24735 16.0554 6.96854 16.0223 6.69821 16.0713C6.42788 16.1204 6.17843 16.2492 5.98203 16.4413L5.93203 16.4913C5.77724 16.6463 5.59343 16.7692 5.3911 16.8531C5.18877 16.937 4.97189 16.9802 4.75286 16.9802C4.53384 16.9802 4.31696 16.937 4.11463 16.8531C3.9123 16.7692 3.72849 16.6463 3.5737 16.4913C3.41874 16.3366 3.29581 16.1527 3.21193 15.9504C3.12806 15.7481 3.08489 15.5312 3.08489 15.3122C3.08489 15.0931 3.12806 14.8763 3.21193 14.6739C3.29581 14.4716 3.41874 14.2878 3.5737 14.133L3.6237 14.083C3.81581 13.8866 3.94469 13.6372 3.9937 13.3668C4.04272 13.0965 4.00963 12.8177 3.8987 12.5663C3.79306 12.3199 3.61766 12.1097 3.39409 11.9616C3.17051 11.8135 2.90852 11.7341 2.64036 11.733H2.4987C2.05667 11.733 1.63275 11.5574 1.32019 11.2449C1.00763 10.9323 0.832031 10.5084 0.832031 10.0663C0.832031 9.62431 1.00763 9.20039 1.32019 8.88783C1.63275 8.57527 2.05667 8.39967 2.4987 8.39967H2.5737C2.84953 8.39322 3.11703 8.30394 3.34145 8.14343C3.56586 7.98293 3.73679 7.75862 3.83203 7.49967C3.94296 7.24833 3.97605 6.96951 3.92703 6.69918C3.87802 6.42885 3.74914 6.17941 3.55703 5.98301L3.50703 5.93301C3.35207 5.77822 3.22914 5.5944 3.14526 5.39207C3.06139 5.18974 3.01822 4.97287 3.01822 4.75384C3.01822 4.53481 3.06139 4.31794 3.14526 4.11561C3.22914 3.91328 3.35207 3.72946 3.50703 3.57467C3.66182 3.41971 3.84563 3.29678 4.04796 3.21291C4.25029 3.12903 4.46717 3.08586 4.6862 3.08586C4.90522 3.08586 5.1221 3.12903 5.32443 3.21291C5.52676 3.29678 5.71058 3.41971 5.86536 3.57467L5.91536 3.62467C6.11176 3.81679 6.36121 3.94566 6.63154 3.99468C6.90187 4.04369 7.18068 4.0106 7.43203 3.89967H7.4987C7.74517 3.79404 7.95538 3.61864 8.10344 3.39506C8.2515 3.17149 8.33096 2.9095 8.33203 2.64134V2.49967C8.33203 2.05765 8.50763 1.63372 8.82019 1.32116C9.13275 1.0086 9.55667 0.833008 9.9987 0.833008C10.4407 0.833008 10.8646 1.0086 11.1772 1.32116C11.4898 1.63372 11.6654 2.05765 11.6654 2.49967V2.57467C11.6664 2.84283 11.7459 3.10482 11.894 3.3284C12.042 3.55197 12.2522 3.72737 12.4987 3.83301C12.75 3.94394 13.0289 3.97703 13.2992 3.92801C13.5695 3.879 13.819 3.75012 14.0154 3.55801L14.0654 3.50801C14.2202 3.35305 14.404 3.23012 14.6063 3.14624C14.8086 3.06237 15.0255 3.0192 15.2445 3.0192C15.4636 3.0192 15.6804 3.06237 15.8828 3.14624C16.0851 3.23012 16.2689 3.35305 16.4237 3.50801C16.5787 3.6628 16.7016 3.84661 16.7855 4.04894C16.8693 4.25127 16.9125 4.46815 16.9125 4.68717C16.9125 4.9062 16.8693 5.12308 16.7855 5.32541C16.7016 5.52774 16.5787 5.71155 16.4237 5.86634L16.3737 5.91634C16.1816 6.11274 16.0527 6.36219 16.0037 6.63252C15.9547 6.90285 15.9878 7.18166 16.0987 7.43301V7.49967C16.2043 7.74615 16.3797 7.95635 16.6033 8.10442C16.8269 8.25248 17.0889 8.33194 17.357 8.33301H17.4987C17.9407 8.33301 18.3646 8.5086 18.6772 8.82116C18.9898 9.13372 19.1654 9.55765 19.1654 9.99967C19.1654 10.4417 18.9898 10.8656 18.6772 11.1782C18.3646 11.4907 17.9407 11.6663 17.4987 11.6663H17.4237C17.1555 11.6674 16.8936 11.7469 16.67 11.8949C16.4464 12.043 16.271 12.2532 16.1654 12.4997V12.4997Z","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}})]),e("defs",[e("clipPath",{attrs:{id:"clip0_1446_43072"}},[e("rect",{attrs:{width:"20",height:"20",fill:"white"}})])])])]),e("div",{staticClass:"card-body"},[""===t.selectedPair.poolId&&t.currencyOutput.address&&t.currencyInput.address?e("div",{staticClass:"create-pool-text"},[t._v(" "+t._s(t.$t("liquidity_addliquidity.create_pool_now"))+" ")]):t._e(),e("div",{staticClass:"swap-currency-input",attrs:{id:"swap-currency-input"},on:{click:function(e){t.isNeedCreatePool&&t.onBorderSign("swap-currency-input")}}},[e("div",{staticClass:"currency flex aic jcsb"},[t.currencyInput.address?e("div",{staticClass:"fl flex aic jcsb",on:{click:function(e){return t.selectToken("input")}}},[e("div",{staticClass:"currency-info flex aic"},[t.currencyInput.piclink?e("img",{attrs:{src:t.currencyInput.piclink,alt:""}}):e("img",{attrs:{src:s("006a"),alt:""}}),e("span",{staticClass:"text"},[t._v(t._s(t.currencyInput.symbol))])]),e("svg",{staticClass:"down",attrs:{width:"12",height:"7",viewBox:"0 0 12 7",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("g",{attrs:{"clip-path":"url(#clip0_243_19969)"}},[e("path",{attrs:{d:"M0.97168 1L6.20532 6L11.439 1","stroke-width":"2"}})]),e("defs",[e("clipPath",{attrs:{id:"clip0_243_19969"}},[e("rect",{attrs:{width:"12",height:"7"}})])])])]):e("div",{staticClass:"fl select flex aic jcsb",on:{click:function(e){return t.selectToken("input")}}},[e("span",{staticClass:"text"},[t._v(t._s(t.$t("liquidity_addliquidity.select_token")))]),e("svg",{attrs:{width:"12",height:"7",viewBox:"0 0 12 7",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{d:"M0.97168 1L6.20532 6L11.439 1"}})])]),e("div",{staticClass:"fr"},[e("el-input",{directives:[{name:"show",rawName:"v-show",value:t.currencyInput.address,expression:"currencyInput.address"}],attrs:{placeholder:t.isNeedCreatePool?"":"0.0",readonly:t.isNeedCreatePool},on:{input:function(e){return t.onInput("input")}},model:{value:t.currencyInput.value,callback:function(e){t.$set(t.currencyInput,"value",e)},expression:"currencyInput.value"}})],1)]),e("div",{staticClass:"balance-box flex aic jcsb"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.isWeb3Connected&&t.currencyInput.address,expression:"isWeb3Connected && currencyInput.address"}],staticClass:"balance"},[e("span",{staticClass:"label"},[t._v(t._s(t.$t("btn.balance"))+":")]),t._v(" "+t._s(t._f("fixedFormatNum")(t.currencyInput.balance))+" "+t._s(t.currencyInput.symbol)),e("span",{staticClass:"max",on:{click:function(e){return t.onInput("input",!0)}}},[t._v("("+t._s(t.$t("btn.max"))+")")])])])]),e("div",{staticClass:"change-img"},[e("div",{staticClass:"img-box"},[e("svg",{attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{d:"M8 3.3335V12.6668","stroke-width":"1.33333","stroke-linecap":"round","stroke-linejoin":"round"}}),e("path",{attrs:{d:"M3.33203 8H12.6654","stroke-width":"1.33333","stroke-linecap":"round","stroke-linejoin":"round"}})])])]),e("div",{staticClass:"swap-currency-output",attrs:{id:"swap-currency-output"},on:{click:function(e){t.isNeedCreatePool&&t.onBorderSign("swap-currency-output")}}},[e("div",{staticClass:"currency flex aic jcsb"},[t.currencyOutput.symbol?e("div",{staticClass:"fl flex aic jcsb",on:{click:function(e){return t.selectToken("output")}}},[e("div",{staticClass:"currency-info flex aic"},[t.currencyOutput.piclink?e("img",{attrs:{src:t.currencyOutput.piclink,alt:""}}):e("img",{attrs:{src:s("006a"),alt:""}}),e("span",{staticClass:"text"},[t._v(t._s(t.currencyOutput.symbol))])]),e("svg",{staticClass:"down",attrs:{width:"12",height:"7",viewBox:"0 0 12 7",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("g",{attrs:{"clip-path":"url(#clip0_243_19969)"}},[e("path",{attrs:{d:"M0.97168 1L6.20532 6L11.439 1","stroke-width":"2"}})]),e("defs",[e("clipPath",{attrs:{id:"clip0_243_19969"}},[e("rect",{attrs:{width:"12",height:"7"}})])])])]):e("div",{staticClass:"fl select flex aic jcsb",on:{click:function(e){return t.selectToken("output")}}},[e("span",{staticClass:"text"},[t._v(t._s(t.$t("liquidity_addliquidity.select_token")))]),e("svg",{attrs:{width:"12",height:"7",viewBox:"0 0 12 7",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{d:"M0.97168 1L6.20532 6L11.439 1"}})])]),e("div",{staticClass:"fr"},[e("el-input",{directives:[{name:"show",rawName:"v-show",value:t.currencyOutput.symbol,expression:"currencyOutput.symbol"}],attrs:{placeholder:t.isNeedCreatePool?"":"0.0",readonly:t.isNeedCreatePool},on:{input:function(e){return t.onInput("output")}},model:{value:t.currencyOutput.value,callback:function(e){t.$set(t.currencyOutput,"value",e)},expression:"currencyOutput.value"}})],1)]),e("div",{staticClass:"balance-box flex aic jcsb"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.isWeb3Connected&&t.currencyOutput.address,expression:"isWeb3Connected && currencyOutput.address"}],staticClass:"balance"},[e("span",{staticClass:"label"},[t._v(t._s(t.$t("btn.balance"))+":")]),t._v(" "+t._s(t._f("fixedFormatNum")(t.currencyOutput.balance))+" "+t._s(t.currencyOutput.symbol)),e("span",{staticClass:"max",on:{click:function(e){return t.onInput("output",!0)}}},[t._v("("+t._s(t.$t("btn.max"))+")")])])])]),""!==t.selectedPair.poolId?e("div",{staticClass:"price-poolshare"},[e("div",{staticClass:"title flex aic"},[t._v(" "+t._s(t.$t("liquidity_addliquidity.prices_share"))+" ")]),e("div",{staticClass:"row flex aic jcsb"},[e("div",{staticClass:"col flex fdc aic jcc"},[e("div",{staticClass:"val"},[t._v(" "+t._s(t._f("fixedFormatNum")("0.0"===t.rate1?"-":t.rate1,6))+" ")]),e("div",{staticClass:"label"},[t._v(" "+t._s(t.currencyOutput.symbol)+" "+t._s(t.$t("liquidity_addliquidity.per"))+" "+t._s(t.currencyInput.symbol)+" ")])]),e("div",{staticClass:"col flex fdc aic jcc"},[e("div",{staticClass:"val"},[t._v(" "+t._s(t._f("fixedFormatNum")("0.0"===t.rate2?"-":t.rate2,6))+" ")]),e("div",{staticClass:"label"},[t._v(" "+t._s(t.currencyInput.symbol)+" "+t._s(t.$t("liquidity_addliquidity.per"))+" "+t._s(t.currencyOutput.symbol)+" ")])]),e("div",{staticClass:"col flex fdc aic jcc"},[e("div",{staticClass:"val"},[t._v(t._s(t._f("fixedFormatNum")(t.shareOfPool,2))+"%")]),e("div",{staticClass:"label"},[t._v(" "+t._s(t.$t("liquidity_addliquidity.share_pool"))+" ")])])])]):t._e(),t.isWeb3Connected&&t.$store.state.environment.networkReady?t.currencyOutput.symbol&&t.currencyInput.symbol?""===t.selectedPair.poolId?e("el-button",{staticClass:"connect-btn ac",attrs:{loading:t.isLoading,id:"createPool"},on:{click:function(e){return t.onCreate(!0)}}},[t._v(t._s(t.$t("liquidity_addliquidity.create_pool")))]):t.isIllegalNumber||!Number("0"+t.currencyInput.realValue)||""!==t.selectedPair.poolId&&""===this.currencyOutput.realValue?e("el-button",{staticClass:"connect-btn"},[t._v(t._s(t.$t("liquidity_addliquidity.enter_amount")))]):Number(t.currencyInput.realValue)>Number(t.currencyInput.balance)?e("el-button",{staticClass:"connect-btn"},[t._v(t._s(t.$t("liquidity_addliquidity.insufficient"))+" "+t._s(t.currencyInput.symbol)+" "+t._s(t.$t("liquidity_addliquidity.balance")))]):Number(t.currencyOutput.realValue)>Number(t.currencyOutput.balance)?e("el-button",{staticClass:"connect-btn"},[t._v(t._s(t.$t("liquidity_addliquidity.insufficient"))+" "+t._s(t.currencyOutput.symbol)+" "+t._s(t.$t("liquidity_addliquidity.balance")))]):t.approve.needApproveCurrencyInput||t.approve.needApproveCurrencyOutput?e("div",{staticClass:"approve-box"},[t.approve.needApproveCurrencyInput?e("el-button",{staticClass:"connect-btn ac",attrs:{loading:t.approve.approveCurrencyInputLoading},on:{click:function(e){return t.onApprove("input")}}},[t._v(t._s(t.$t("btn.approve"))+" "+t._s(t.currencyInput.symbol))]):t._e(),t.approve.needApproveCurrencyOutput?e("el-button",{staticClass:"connect-btn ac",staticStyle:{"margin-left":"0"},style:{marginTop:(t.approve.needApproveCurrencyInput?12:20)+"px"},attrs:{loading:t.approve.approveCurrencyOutputLoading},on:{click:function(e){return t.onApprove("output")}}},[t._v(t._s(t.$t("btn.approve"))+" "+t._s(t.currencyOutput.symbol))]):t._e(),e("el-button",{staticClass:"connect-btn add_liquidity",staticStyle:{"margin-left":"0"}},[t._v(t._s(t.$t("liquidity_addliquidity.add_liquidity")))])],1):e("el-button",{staticClass:"connect-btn ac",attrs:{loading:t.isLoading},on:{click:t.onAddLiquidity}},[t._v(t._s(t.$t("liquidity_addliquidity.add_liquidity")))]):e("el-button",{staticClass:"connect-btn"},[t._v(t._s(t.$t("liquidity_addliquidity.invalid_pair")))]):e("connect-wallet-btn",{staticClass:"connect-btn btn",attrs:{text:t.$t("connect_wallet_btn.connect_wallet")}})],1)]),e("select-token",{attrs:{"select-token-dialog":t.selectTokenDialog,"token-list":t.tokenList},on:{setCurrency:t.setCurrency,closeDialog:function(e){t.selectTokenDialog=!1}}})],1)},r=[],a=(s("d9e2"),s("14d9"),s("ed08")),n=s("365c"),o=s("6393"),c=s("06bb"),u=s("26ba"),l={name:"AddLiquidity",mixins:[],components:{SelectToken:c["a"]},props:{},data(){return{approve:{needApproveCurrencyInput:!0,needApproveCurrencyOutput:!0,approveCurrencyInputLoading:!1,approveCurrencyOutputLoading:!1},rate1:"",rate2:"",shareOfPool:"",isLoading:!1,onFormatInput:a["j"],currencyInput:{piclink:"",symbol:"",balance:"",value:"",realValue:"",address:"",price:""},currencyOutput:{piclink:"",symbol:"",value:"",realValue:"",balance:"",address:"",price:""},selectTokenDialog:!1,searchToken:"",currenyTokenType:"",pairList:JSON.parse(localStorage.getItem("pairList")||"[]"),coinList:JSON.parse(localStorage.getItem("coinList")||"[]"),selectedPair:{poolId:"",fromToken0:null,token0:"",token1:"",tk0Decimals:18,tk1Decimals:18},inputTimer:null,tokenList:[],isFirstAddLiquidity:!0,isNeedCreatePool:!1}},filters:{},computed:{isWeb3Connected(){return this.$store.getters.isWeb3Connected},walletInfo(){return this.$store.getters.walletInfo},activeCoinList:function(){return this.tokenList&&this.tokenList.length?this.tokenList:[]},version(){return this.$store.state.environment.version},wrapTokenAddress(){return this.$store.getters.wrapTokenAddress},platformToken(){return this.$store.getters.platformToken},projectid(){return this.$store.getters.projectid},networkName(){return this.$store.getters.network},isIllegalNumber(){try{return this.$parseUnits(this.currencyInput.realValue,this.selectedPair.tk0Decimals),this.$parseUnits(this.currencyOutput.realValue,this.selectedPair.tk1Decimals),!1}catch{return!0}}},watch:{"$store.getters.walletInfo":{deep:!0,handler(){this.init()}},selectTokenDialog(t){t||(this.searchToken="",this.tokenList=JSON.parse(JSON.stringify(this.coinList)))},"selectedPair.poolId"(t){if(0===t||t)this.setNeedApprove(),this.$route.query.poolid!=t&&this.$router.replace({query:Object.assign({},this.$route.query,{poolid:t})});else{let t=JSON.parse(JSON.stringify(this.$route.query));delete t.poolid,this.$router.replace({query:Object.assign({},t)})}},currencyInput:{deep:!0,handler(){this.setNeedApprove()}},currencyOutput:{deep:!0,handler(){this.setNeedApprove()}}},created(){},activated(){this.init()},mounted(){},destroyed(){},methods:{async onCreate(){this.isLoading=!0;let t=this.currencyInput.address,e=this.currencyOutput.address,s=this.currencyInput.symbol,i=this.currencyOutput.symbol;t.toLocaleLowerCase()===this.platformToken&&(t=this.wrapTokenAddress,s=this.$store.state.environment.wrapTokenSymbol),e.toLocaleLowerCase()===this.platformToken&&(e=this.wrapTokenAddress,i=this.$store.state.environment.wrapTokenSymbol);let r=this.projectid,n=0;try{let o=await u["g"](t,e,r,n),c=Number(o.poolID),l={projectid:r,poolid:c,network:this.networkName,inserttime:Object(a["g"])(new Date)};l="v2_0"!==this.version&&this.$BigNumber.from(t).gt(e)?Object.assign({},l,{token0address:e.toLocaleLowerCase(),token1address:t.toLocaleLowerCase(),token0logo:this.currencyOutput.piclink,token1logo:this.currencyInput.piclink,token0symbol:i,token1symbol:s,poolname:i+"-"+s}):Object.assign({},l,{token0address:t.toLocaleLowerCase(),token1address:e.toLocaleLowerCase(),token0logo:this.currencyInput.piclink,token1logo:this.currencyOutput.piclink,token0symbol:s,token1symbol:i,poolname:s+"-"+i}),this.createPool(l)}catch(o){return this.isLoading=!1,void this.$notify.error({title:this.$t("notify.error"),message:o.message})}},createPool(t){Object(n["b"])(t).then(t=>{"200"==t.code&&(this.isLoading=!1,this.$notify.success({title:this.$t("notify.succeeded")}),this.getpool())})},init(){this.getpool(!0),this.getcoin()},getpool(t=!1){Object(n["e"])({projectid:this.projectid}).then(e=>{"200"===e.code&&(this.pairList=e.result,localStorage.setItem("pairList",JSON.stringify(this.pairList)),this.$route.query.poolid&&t?this.pairList.some(t=>{if(t.poolid==this.$route.query.poolid)return this.currencyInput.address?this.getBalance(this.currencyInput.address):(this.currenyTokenType="input",t.token0address.toLocaleLowerCase()===this.wrapTokenAddress?this.coinList.some(t=>{t.symbol.toLocaleLowerCase()==this.platformToken&&this.setCurrency({piclink:t.piclink,symbol:t.symbol,address:t.address,price:t.price})}):this.setCurrency({piclink:t.token0logo,symbol:t.token0symbol,address:t.token0address,price:t.priceOfTk0})),this.currencyOutput.address?this.getBalance(this.currencyOutput.address,"output"):(this.currenyTokenType="output",t.token1address.toLocaleLowerCase()===this.wrapTokenAddress?this.coinList.some(t=>{t.symbol.toLocaleLowerCase()==this.platformToken&&this.setCurrency({piclink:t.piclink,symbol:t.symbol,address:t.address,price:t.price})}):this.setCurrency({piclink:t.token1logo,symbol:t.token1symbol,address:t.token1address,price:t.priceOfTk1})),!0}):this.getPid())})},async getcoin(){Object(n["d"])({projectid:this.projectid,network:this.networkName}).then(t=>{if("200"===t.code){if(this.coinList=t.result.coins,this.tokenList=JSON.parse(JSON.stringify(t.result.coins)),localStorage.setItem("coinList",JSON.stringify(this.coinList)),this.$route.query.poolid||(this.currencyInput.address?this.getBalance(this.currencyInput.address):this.setCurrencyInput(this.coinList[0])),!t.result.usercoin.network)return this.$message.closeAll(),void this.$message.error("projectid Error");this.isWeb3Connected&&!this.$store.state.environment.networkReady&&this.$message.closeAll()}})},getBalance(t,e="input"){t&&u["j"](t).then(t=>{"input"===e?this.currencyInput.balance=this.$formatUnits(t):this.currencyOutput.balance=this.$formatUnits(t)}).catch(t=>{console.error(t)})},setCurrencyInput(t,e=!1){!t||this.currencyInput.symbol&&!e||(this.currencyInput.piclink=t.piclink,this.currencyInput.symbol=t.symbol,this.currencyInput.address=t.address,this.currencyInput.price=t.price,(this.currencyOutput.address&&this.currencyOutput.address.toLocaleLowerCase()===this.currencyInput.address.toLocaleLowerCase()||this.currencyInput.address.toLocaleLowerCase()===this.platformToken&&this.wrapTokenAddress===this.currencyOutput.address.toLocaleLowerCase()||this.currencyInput.address.toLocaleLowerCase()===this.wrapTokenAddress&&this.platformToken===this.currencyOutput.address.toLocaleLowerCase())&&(this.currencyOutput={piclink:"",symbol:"",balance:"",value:"",realValue:"",address:"",price:""}),this.isWeb3Connected&&this.getBalance(this.currencyInput.address))},async getLiquidity(t){let e=t.poolid;try{let s=await u["L"](e);t.liquidity=this.$formatUnits(s,18)}catch(s){throw new Error(s)}},async getDeposited(t){let e=t.poolid;try{let s=await u["k"](e);t.deposited=this.$formatUnits(s,18)}catch(s){throw new Error(s)}},getPid(){if(this.selectedPair={poolId:"",fromToken0:null,token0:"",token1:"",tk0Decimals:18,tk1Decimals:18},this.isNeedCreatePool=!1,this.currencyInput.address&&this.currencyOutput.address){let t=this.currencyInput.address,e=this.currencyOutput.address;t.toLocaleLowerCase()===this.platformToken&&(t=this.wrapTokenAddress),e.toLocaleLowerCase()===this.platformToken&&(e=this.wrapTokenAddress);let s=[];this.pairList.forEach(i=>{let r=this.$BigNumber.from(i.token0address),a=this.$BigNumber.from(i.token1address);(r.eq(t)&&a.eq(e)||r.eq(e)&&a.eq(t))&&s.push(i)});let i=()=>{let i=this.$BigNumber.from(s[0].token0address),r=this.$BigNumber.from(s[0].token1address);(i.eq(t)&&r.eq(e)||i.eq(e)&&r.eq(t))&&(this.selectedPair.poolId=s[0].poolid,this.selectedPair.token0=s[0].token0address,this.selectedPair.token1=s[0].token1address,(async()=>{let t=this.getIsFirstAddLiquidity(this.selectedPair.poolId),e=u["x"](this.selectedPair.token0),s=u["x"](this.selectedPair.token1);this.isFirstAddLiquidity=await t,this.selectedPair.tk0Decimals=await e,this.selectedPair.tk1Decimals=await s,this.getRate(),this.getPoolAssets()})()),i.eq(t)&&r.eq(e)?this.selectedPair.fromToken0=!0:this.$BigNumber.from(s[0].token0address).eq(e)&&this.$BigNumber.from(s[0].token1address).eq(t)&&(this.selectedPair.fromToken0=!1)};(async()=>{if(1==s.length)i();else if(s.length>1){for(let t of s)await this.getDeposited(t),await this.getLiquidity(t);s.sort((t,e)=>Number(t.deposited)!=Number(e.deposited)?Number(e.deposited)-Number(t.deposited):Number(t.liquidity)!=Number(e.liquidity)?Number(e.liquidity)-Number(t.liquidity):Number(t.poolid)-Number(e.poolid)),i()}this.setInputValue(),""===this.selectedPair.poolId&&(this.currencyInput.value="",this.currencyOutput.value="",this.currencyInput.realValue="",this.currencyOutput.realValue="",this.isNeedCreatePool=!0)})()}},async getPoolAssets(){let t=await u["C"](this.selectedPair.poolId),e=t.reserves0,s=this.currencyInput.address;if(s.toLocaleLowerCase()===this.platformToken&&(s=this.wrapTokenAddress),this.$BigNumber.from(s).eq(this.selectedPair.token0))if(0===Number(this.currencyInput.value))this.shareOfPool="0";else try{this.shareOfPool=this.$formatUnits(this.$parseUnits(this.currencyInput.realValue,this.selectedPair.tk0Decimals).mul(this.$parseUnits("100")).div(this.$parseUnits(this.currencyInput.realValue,this.selectedPair.tk0Decimals).add(e)))}catch{this.shareOfPool="0"}else if(0===Number(this.currencyOutput.value))this.shareOfPool="0";else try{this.shareOfPool=this.$formatUnits(this.$parseUnits(this.currencyOutput.realValue,this.selectedPair.tk0Decimals).mul(this.$parseUnits("100")).div(this.$parseUnits(this.currencyOutput.realValue,this.selectedPair.tk0Decimals).add(e)))}catch{this.shareOfPool="0"}},async getIsFirstAddLiquidity(t){let e=await u["C"](t),s=e.reserves0,i=e.reserves1;return 0===Number(s)&&0===Number(i)},debounce(t,e,s,i=200){this.inputTimer&&clearTimeout(this.inputTimer),this.inputTimer=setTimeout(()=>{t(e,s)},i)},setInputValue(){""===this.currencyInput.realValue&&""===this.currencyOutput.realValue||(""!==this.currencyInput.realValue?this.onInput("input"):""!==this.currencyOutput.realValue&&this.onInput("output"))},onInput(t,e=!1){this.debounce((t,e)=>{if("input"===t){if(e?(this.currencyInput.value=this.currencyInput.balance,this.currencyInput.realValue=this.currencyInput.balance):(this.onFormatInput("currencyInput.value",!0),this.currencyInput.realValue=this.currencyInput.value),!isNaN(this.currencyInput.realValue)&&!this.isFirstAddLiquidity){let t=this.currencyInput.address.toLocaleLowerCase()===this.platformToken?this.$BigNumber.from(this.wrapTokenAddress).eq(this.selectedPair.token0):this.$BigNumber.from(this.currencyInput.address).eq(this.selectedPair.token0);this.getAmountOut(this.currencyInput.realValue,t).then(t=>{this.currencyOutput=Object.assign({},this.currencyOutput,{value:Number("0"+this.currencyInput.value)?this.$exponentialToNumber1(t):"",realValue:Number("0"+this.currencyInput.value)?t:""}),""!==this.selectedPair.poolId&&this.getPoolAssets(this.selectedPair.poolId)}).catch(()=>{this.currencyOutput=Object.assign({},this.currencyOutput,{value:"",realValue:""}),""!==this.selectedPair.poolId&&this.getPoolAssets(this.selectedPair.poolId)})}}else if("output"===t&&(e?(this.currencyOutput.value=this.currencyOutput.balance,this.currencyOutput.realValue=this.currencyOutput.balance):(this.onFormatInput("currencyOutput.value",!0),this.currencyOutput.realValue=this.currencyOutput.value),!isNaN(this.currencyOutput.value)&&!this.isFirstAddLiquidity)){let t=this.currencyOutput.address.toLocaleLowerCase()===this.platformToken?this.$BigNumber.from(this.wrapTokenAddress).eq(this.selectedPair.token0):this.$BigNumber.from(this.currencyOutput.address).eq(this.selectedPair.token0);this.getAmountOut(this.currencyOutput.realValue,t).then(t=>{this.currencyInput=Object.assign({},this.currencyInput,{value:Number("0"+this.currencyOutput.value)?this.$exponentialToNumber1(t):"",realValue:Number("0"+this.currencyOutput.value)?t:""}),""!==this.selectedPair.poolId&&this.getPoolAssets(this.selectedPair.poolId)}).catch(()=>{this.currencyInput=Object.assign({},this.currencyInput,{value:"",realValue:""}),""!==this.selectedPair.poolId&&this.getPoolAssets(this.selectedPair.poolId)})}},t,e)},getRate(){let t=this.currencyInput.address.toLocaleLowerCase()===this.platformToken?this.$BigNumber.from(this.wrapTokenAddress).eq(this.selectedPair.token0):this.$BigNumber.from(this.currencyInput.address).eq(this.selectedPair.token0);this.getAmountOut("1",t).then(t=>{this.rate1=t});let e=this.currencyInput.address.toLocaleLowerCase()===this.platformToken?!this.$BigNumber.from(this.wrapTokenAddress).eq(this.selectedPair.token0):!this.$BigNumber.from(this.currencyInput.address).eq(this.selectedPair.token0);this.getAmountOut("1",e).then(t=>{this.rate2=t})},async getAmountOut(t,e){let s=this.selectedPair.poolId;if(this.isFirstAddLiquidity=await this.getIsFirstAddLiquidity(this.selectedPair.poolId),this.isFirstAddLiquidity)return"0";{let i=await u["C"](s);if(e)try{let e=this.$formatUnits(i.gReserves1.mul(this.$parseUnits(t,this.selectedPair.tk0Decimals)).div(i.gReserves0),this.selectedPair.tk1Decimals);return e}catch{return""}else try{let e=this.$formatUnits(i.gReserves0.mul(this.$parseUnits(t,this.selectedPair.tk1Decimals)).div(i.gReserves1),this.selectedPair.tk0Decimals);return e}catch{return""}}},selectToken(t){this.currenyTokenType=t,this.selectTokenDialog=!0},setCurrency(t){"input"===this.currenyTokenType?this.setCurrencyInput(t,!0):(this.currencyOutput.piclink=t.piclink,this.currencyOutput.symbol=t.symbol,this.currencyOutput.address=t.address,this.currencyOutput.price=t.price,(this.currencyInput.address&&this.currencyOutput.address.toLocaleLowerCase()===this.currencyInput.address.toLocaleLowerCase()||this.currencyOutput.address.toLocaleLowerCase()===this.platformToken&&this.wrapTokenAddress===this.currencyInput.address.toLocaleLowerCase()||this.currencyOutput.address.toLocaleLowerCase()===this.wrapTokenAddress&&this.platformToken===this.currencyInput.address.toLocaleLowerCase())&&(this.currencyInput={piclink:"",symbol:"",balance:"",value:"",realValue:"",address:"",price:""}),this.isWeb3Connected&&this.getBalance(this.currencyOutput.address,"output")),this.getPid(),this.selectTokenDialog=!1},async setNeedApprove(){let t="EncV2Router02";"v2_0"===this.version&&(t="SwapPoolERC20");const e=await o["f"](t);let s=this.selectedPair.fromToken0?this.selectedPair.tk0Decimals:this.selectedPair.tk1Decimals,i=this.selectedPair.fromToken0?this.selectedPair.tk1Decimals:this.selectedPair.tk0Decimals,r=this.$parseUnits("0"+this.currencyInput.realValue,s),a=this.$parseUnits("0"+this.currencyOutput.realValue,i),n=await o["j"](r,this.currencyInput.address,e);this.approve.needApproveCurrencyInput=n;let c=await o["j"](a,this.currencyOutput.address,e);this.approve.needApproveCurrencyOutput=c},async onApprove(t){let e="EncV2Router02";"v2_0"===this.version&&(e="SwapPoolERC20");const s=await o["f"](e);if("input"===t)try{this.approve.approveCurrencyInputLoading=!0,await o["a"](this.currencyInput.address,s),this.approve.needApproveCurrencyInput=!1,this.approve.approveCurrencyInputLoading=!1}catch{this.approve.approveCurrencyInputLoading=!1}else try{this.approve.approveCurrencyOutputLoading=!0,await o["a"](this.currencyOutput.address,s),this.approve.needApproveCurrencyOutput=!1,this.approve.approveCurrencyOutputLoading=!1}catch{this.approve.approveCurrencyOutputLoading=!1}},async onAddLiquidity(){let t,e;this.isLoading=!0;let s,i,r,a=this.currencyInput.address,n=this.currencyOutput.address;try{let o=a.toLocaleLowerCase()===this.platformToken?this.$BigNumber.from(this.wrapTokenAddress).eq(this.selectedPair.token0):this.$BigNumber.from(a).eq(this.selectedPair.token0);a.toLocaleLowerCase()===this.platformToken?(a=this.wrapTokenAddress,i=await u["x"](a),s=this.$parseUnits("0"+this.currencyInput.realValue,i)):n.toLocaleLowerCase()===this.platformToken&&(n=this.wrapTokenAddress,r=await u["x"](n),s=this.$parseUnits("0"+this.currencyOutput.realValue,r)),i=await u["x"](a),r=await u["x"](n),o?(t=this.$parseUnits("0"+this.currencyInput.realValue,i),e=this.$parseUnits("0"+this.currencyOutput.realValue,r)):(e=this.$parseUnits("0"+this.currencyInput.realValue,i),t=this.$parseUnits("0"+this.currencyOutput.realValue,r))}catch{return this.isLoading=!1,void this.$notify.error({title:this.$t("notify.error"),message:this.$t("liquidity_addliquidity.enter_amount")})}let c=this.selectedPair.poolId;try{s?await u["e"](c,t,e,s):await u["f"](c,t,e),this.resetForm(),this.getRate(),this.shareOfPool="0";const i=await o["f"]("SwapPoolERC20");this.requestAddLiquidity({admin:this.walletInfo.address.toLocaleLowerCase(),poolid:c,pooladdress:i.toLocaleLowerCase(),projectid:this.projectid,network:this.networkName})}catch(l){return this.isLoading=!1,void this.$notify.error({title:this.$t("notify.error"),message:l.message})}},requestAddLiquidity(t){Object(n["a"])(t).then(t=>{"200"==t.code||console.error("addLiquidity_error")})},resetForm(){this.$notify.success({title:this.$t("notify.succeeded")}),this.currencyInput.value="",this.currencyOutput.value="",this.currencyInput.realValue="",this.currencyOutput.realValue="",this.isLoading=!1,this.getBalance(this.currencyInput.address),this.getBalance(this.currencyOutput.address,"output")},onBack(){window.history.length>1?this.$router.back():this.$router.replace({path:"/trade/liquidity",query:Object.assign({},this.$route.query)})},onBorderSign(t){var e=document.getElementById(t);e.setAttribute("class",t+" borderSign"),setTimeout(()=>{var t=document.getElementById("createPool");t.setAttribute("class","connect-btn backgroundSign")},100),setTimeout(()=>{var t=document.getElementById("createPool");t.setAttribute("class","connect-btn ac")},250)}}},d=l,p=(s("7f1d"),s("2877")),h=Object(p["a"])(d,i,r,!1,null,"e97bb5c6",null);e["default"]=h.exports}}]);